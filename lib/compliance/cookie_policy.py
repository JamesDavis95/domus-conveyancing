"""
Cookie Policy for Domus Conveyancing Platform
Comprehensive cookie usage and management policy
"""

COOKIE_POLICY = """
# Cookie Policy

**Last Updated:** {last_updated}
**Effective Date:** {effective_date}

## 1. Introduction

This Cookie Policy explains how Domus Conveyancing Limited ("we," "our," or "us") uses cookies and similar tracking technologies on our platform ("Platform"). This policy should be read alongside our Privacy Policy and Terms of Service.

## 2. What Are Cookies?

Cookies are small text files that are placed on your device (computer, smartphone, tablet) when you visit websites. They are widely used to make websites work efficiently and provide information to website owners.

### 2.1 Types of Cookies

**Session Cookies:** Temporary cookies that are deleted when you close your browser
**Persistent Cookies:** Cookies that remain on your device for a set period or until manually deleted
**First-Party Cookies:** Set by our Platform directly
**Third-Party Cookies:** Set by external services we use

## 3. How We Use Cookies

### 3.1 Essential Cookies
These cookies are necessary for the Platform to function properly:

**Authentication Cookies:**
- `session_token`: Maintains your login session
- `csrf_token`: Protects against cross-site request forgery
- `2fa_verified`: Tracks two-factor authentication status

**Security Cookies:**
- `rate_limit_tracker`: Monitors request frequency for security
- `captcha_verified`: Tracks CAPTCHA completion status
- `security_level`: Maintains your security clearance level

**Platform Functionality:**
- `user_preferences`: Remembers your settings and preferences
- `transaction_state`: Maintains your current transaction progress
- `document_view_state`: Remembers document viewing preferences

### 3.2 Analytics Cookies
These cookies help us understand how you use our Platform:

**Usage Analytics:**
- `_ga`: Google Analytics tracking (anonymized)
- `_gid`: Google Analytics session tracking
- `platform_analytics`: Our internal usage tracking

**Performance Monitoring:**
- `performance_data`: Page load times and errors
- `user_journey`: Navigation patterns (anonymized)
- `feature_usage`: Feature adoption and engagement

### 3.3 Preference Cookies
These cookies remember your choices and settings:

**User Interface:**
- `theme_preference`: Light/dark mode selection
- `language_preference`: Your chosen language
- `dashboard_layout`: Customized dashboard arrangement

**Communication Preferences:**
- `notification_settings`: Your notification preferences
- `communication_method`: Preferred contact methods
- `timezone_setting`: Your local timezone setting

### 3.4 Marketing Cookies (With Consent)
These cookies are used for marketing purposes when you consent:

**Campaign Tracking:**
- `utm_source`: Marketing campaign source
- `utm_medium`: Marketing campaign medium
- `utm_campaign`: Specific campaign identifier

**Personalization:**
- `marketing_profile`: Anonymized interest profile
- `content_preference`: Preferred content types
- `engagement_score`: Interaction level tracking

## 4. Third-Party Cookies

### 4.1 Google Services
We use Google services that may set cookies:

**Google Analytics:**
- Purpose: Website analytics and performance monitoring
- Data: Anonymized usage statistics
- Retention: 26 months
- Opt-out: Available through Google Analytics opt-out

**Google Fonts:**
- Purpose: Consistent typography across the Platform
- Data: Font loading preferences
- Retention: 1 year

### 4.2 Stripe (Payment Processing)
**Stripe Cookies:**
- Purpose: Secure payment processing and fraud prevention
- Data: Payment session information
- Retention: Session-based
- Privacy: Subject to Stripe's privacy policy

### 4.3 Identity Verification Services
**Onfido/Jumio Cookies:**
- Purpose: Identity verification and compliance
- Data: Verification session data
- Retention: Session-based
- Privacy: Subject to provider privacy policies

### 4.4 Cloud Services (AWS/Google Cloud)
**Infrastructure Cookies:**
- Purpose: Load balancing and performance optimization
- Data: Technical routing information
- Retention: Session-based

## 5. Cookie Management

### 5.1 Your Cookie Choices
You can control cookies through:

**Platform Cookie Settings:**
- Access through "Cookie Preferences" in your account
- Granular control over cookie categories
- Easy opt-in/opt-out for non-essential cookies

**Browser Settings:**
- Enable/disable cookies entirely
- Delete existing cookies
- Set preferences for future cookies
- Private/incognito browsing modes

### 5.2 Consent Management
We implement a consent management system that:
- Requests explicit consent for non-essential cookies
- Provides clear information about each cookie type
- Allows you to change preferences at any time
- Respects your choices across sessions

### 5.3 Cookie Categories and Control

**Always Active (Essential):**
- Cannot be disabled as they're required for Platform functionality
- Include security, authentication, and core features

**Analytics (Optional):**
- Can be disabled while maintaining full Platform functionality
- Help us improve services and user experience
- Data is anonymized and aggregated

**Marketing (Optional):**
- Requires explicit consent
- Can be disabled without affecting Platform use
- Used for personalized communications and content

## 6. Cookie Details

### 6.1 Essential Cookies Table

| Cookie Name | Purpose | Duration | Domain |
|-------------|---------|----------|--------|
| session_token | User authentication | Session | .domusconveyancing.co.uk |
| csrf_token | Security protection | Session | .domusconveyancing.co.uk |
| 2fa_verified | Two-factor auth status | 24 hours | .domusconveyancing.co.uk |
| rate_limit_tracker | Security monitoring | 1 hour | .domusconveyancing.co.uk |
| user_preferences | Platform settings | 1 year | .domusconveyancing.co.uk |

### 6.2 Analytics Cookies Table

| Cookie Name | Purpose | Duration | Domain |
|-------------|---------|----------|--------|
| _ga | Google Analytics | 2 years | .domusconveyancing.co.uk |
| _gid | Google Analytics session | 24 hours | .domusconveyancing.co.uk |
| platform_analytics | Internal analytics | 1 year | .domusconveyancing.co.uk |
| performance_data | Performance monitoring | 30 days | .domusconveyancing.co.uk |

### 6.3 Marketing Cookies Table

| Cookie Name | Purpose | Duration | Domain |
|-------------|---------|----------|--------|
| utm_campaign | Campaign tracking | 30 days | .domusconveyancing.co.uk |
| marketing_profile | Interest profiling | 1 year | .domusconveyancing.co.uk |
| engagement_score | Interaction tracking | 6 months | .domusconveyancing.co.uk |

## 7. Similar Technologies

### 7.1 Local Storage
We use browser local storage for:
- Temporary data during transactions
- Offline functionality
- Large preference datasets

### 7.2 Session Storage
We use session storage for:
- Form data preservation
- Temporary calculations
- Single-session preferences

### 7.3 Web Beacons
We may use web beacons (pixel tags) for:
- Email open tracking (with consent)
- Page view confirmation
- Campaign effectiveness measurement

## 8. Data Protection and Privacy

### 8.1 Personal Data in Cookies
Most cookies we use contain:
- Pseudonymized identifiers
- Technical configuration data
- Anonymized usage statistics

We do not store sensitive personal data in cookies.

### 8.2 Cross-Border Data Transfers
Some third-party services may transfer cookie data internationally. We ensure:
- Adequate protection mechanisms
- Compliance with UK GDPR requirements
- Transparent disclosure of transfers

### 8.3 Data Retention
Cookie data is retained for:
- Essential cookies: Duration of session or as required for functionality
- Analytics cookies: Maximum 26 months
- Marketing cookies: Maximum 12 months (with consent)

## 9. Your Rights

### 9.1 Access and Control
You have the right to:
- View all cookies set on your device
- Understand the purpose of each cookie
- Control non-essential cookie usage
- Delete cookies at any time

### 9.2 Complaints
If you have concerns about our cookie usage:
- Contact our Data Protection Officer: dpo@domusconveyancing.co.uk
- File a complaint with the Information Commissioner's Office (ICO)

## 10. Updates to This Policy

### 10.1 Policy Changes
We may update this Cookie Policy to reflect:
- New cookie implementations
- Changes in third-party services
- Regulatory requirements
- User feedback and best practices

### 10.2 Notification of Changes
We will notify you of significant changes through:
- Platform notifications
- Email communications
- Updated policy timestamps

## 11. How to Contact Us

**Data Protection Enquiries:**
Email: dpo@domusconveyancing.co.uk
Phone: 020 1234 5678

**Technical Support:**
Email: support@domusconveyancing.co.uk

**General Enquiries:**
Email: info@domusconveyancing.co.uk

**Postal Address:**
Domus Conveyancing Limited
Cookie Policy Enquiries
[Full Address]
United Kingdom

## 12. Useful Links

- **Our Privacy Policy:** [Link to Privacy Policy]
- **Terms of Service:** [Link to Terms]
- **Cookie Preferences:** [Link to Cookie Settings]
- **Google Analytics Opt-out:** https://tools.google.com/dlpage/gaoptout
- **ICO Cookie Guidance:** https://ico.org.uk/for-organisations/guide-to-pecr/cookies-and-similar-technologies/

---

This Cookie Policy is part of our commitment to transparency and user control over personal data. We regularly review our cookie usage to ensure it remains necessary, proportionate, and privacy-compliant.
"""

def get_cookie_policy(last_updated=None, effective_date=None):
    """Get formatted cookie policy"""
    
    if not last_updated:
        from datetime import datetime
        last_updated = datetime.now().strftime("%d %B %Y")
    
    if not effective_date:
        effective_date = "1 January 2024"
    
    return COOKIE_POLICY.format(
        last_updated=last_updated,
        effective_date=effective_date
    )